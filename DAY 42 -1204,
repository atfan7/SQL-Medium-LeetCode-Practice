PROBLEM 1204:::

with cte as (
select 
*,sum(weight) over(order by turn asc) as TW
from 
Queue ),

cte1 as (

select person_name , TW
from cte where TW<=1000
)

select person_name
from cte1 
order by TW desc 
limit 1

