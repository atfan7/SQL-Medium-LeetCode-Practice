PROBLEM 2394:::

with cte as (
select employee_id, sum(ceil((timestampdiff(second,in_time,out_time))/60)) as td

from Logs
group by employee_id
)

select 
e.employee_id
from Employees  e left join cte c
on e.employee_id =c.employee_id
where ifnull(c.td,0) < e.needed_hours *60

PROBLEM 2686 :::

with cte as (
SELECT 

*, 
case when customer_pref_delivery_date =order_date
then 'immediate' else 'scheduled' end as type
FROM 

Delivery )

select 
order_date,round ((sum(case when type ='immediate' then 1 else 0 end)/count(type))*100 ,2) as immediate_percentage
from 
cte 
group by order_date
order by order_date
