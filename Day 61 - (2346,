PROBLEM 2346 :::

with cte as (

select

student_id,department_id, rank() over(partition by department_id order by mark desc ) as rnk,
count(student_id) over(partition by department_id) as cnt 
from 
Students
)

select
student_id,department_id,ifnull( round (((rnk-1) *100)/(cnt-1),2),0) as percentage 
from cte 
